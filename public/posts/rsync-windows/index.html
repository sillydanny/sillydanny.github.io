<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Synchronization Solution on Windows (RSYNC) | King's Blog</title><meta name=keywords content="rsync"><meta name=description content="Synchronization Solution on Windows (RSYNC)"><meta name=author content="King Tam"><link rel=canonical href=https://www.kingtam.tk/posts/rsync-windows/><link crossorigin=anonymous href=/assets/css/stylesheet.bf5f9f73cf17311d52cedbcda82c922e91b2f566d88a85ad9f5b5a08b586bd5f.css integrity="sha256-v1+fc88XMR1SztvNqCySLpGy9WbYioWtn1taCLWGvV8=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.acb54fd32bbc1982428b8850317e45d076b95012730a5936667e6bc21777692a.js integrity="sha256-rLVP0yu8GYJCi4hQMX5F0Ha5UBJzClk2Zn5rwhd3aSo=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://www.kingtam.tk/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.kingtam.tk/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.kingtam.tk/favicon-32x32.png><link rel=apple-touch-icon href=https://www.kingtam.tk/apple-touch-icon.png><link rel=mask-icon href=https://www.kingtam.tk/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Synchronization Solution on Windows (RSYNC)"><meta property="og:description" content="Synchronization Solution on Windows (RSYNC)"><meta property="og:type" content="article"><meta property="og:url" content="https://www.kingtam.tk/posts/rsync-windows/"><meta property="og:image" content="https://www.kingtam.tk/img/rsync-windows/rsync-windows.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-06-09T09:34:28+08:00"><meta property="article:modified_time" content="2023-06-09T09:34:28+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.kingtam.tk/img/rsync-windows/rsync-windows.jpg"><meta name=twitter:title content="Synchronization Solution on Windows (RSYNC)"><meta name=twitter:description content="Synchronization Solution on Windows (RSYNC)"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.kingtam.tk/posts/"},{"@type":"ListItem","position":2,"name":"Synchronization Solution on Windows (RSYNC)","item":"https://www.kingtam.tk/posts/rsync-windows/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Synchronization Solution on Windows (RSYNC)","name":"Synchronization Solution on Windows (RSYNC)","description":"Synchronization Solution on Windows (RSYNC)","keywords":["rsync"],"articleBody":"img from unsplash\nThese are the basic steps to set up and use an rsync tool for synchronization on Windows.\nRSYNC Server Setup RSYNC Server on Windows i. Manual Setup Install RSYNC on the server machines. Install Rsync software like a linux through Chocolatey 1 choco install rsync -y On the server, create a folder to share 1 mkdir -p C:\\rsync_share e.g. C:\\rsync_share. as rsync share folder.\nOn the server,Create the C:\\rsync\\rsyncd.conf file with the following contents: 1 2 3 4 5 6 [rsync_share] path = /cygdrive/c/rsync_share use chroot = no ignore errors read only = no list = yes This configures the share name as “rsync_share” pointing to the C:\\rsync_share folder.\nUse cygdrive path prefix as /cygdrive/c/rsync_share\nOn the server, open PowerShell and run the rsync daemon: 1 rsync --daemon --config=C:\\rsync\\rsyncd.conf This will run the rsync daemon using the config file C:\\rsync\\rsyncd.conf.\nYou may need to configure firewall rules on the server to allow incoming TCP connections to port 873\n(The rsync daemon default port).\nRsync service is set to run automatically on startup on the server via “Task Scheduler”.\nii. Automatic via Script Here are Windows scripts to automatically install rsync, configure it, and open the firewall port:\nUpdate Policy to allow execute self PowerShell script. 1 Set-ExecutionPolicy RemoteSigned Execution Policy Change The execution policy helps protect you from scripts that you do not trust. Changing the execution policy might expose you to the security risks described in the about_Execution_Policies help topic at https:/go.microsoft.com/fwlink/?LinkID=135170. Do you want to change the execution policy? [Y] Yes [A] Yes to All [N] No [L] No to All [S] Suspend [?] Help (default is “N”): y\nCreate Windows PowerShell Script Save all below content to a PowerShell script as names “rsync-config.ps1”\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 # Create rsync config and share folders New-Item -Path C:\\rsync -ItemType Directory New-Item -Path C:\\rsync_share -ItemType Directory # Create rsync.conf file @\" [rsync_share] path = /cygdrive/c/rsync_share ignore errors read only = no list = yes auth users = rsync secrets file = /cygdrive/c/rsync/rsync.passwd \"@ | Add-Content -Path C:\\rsync\\rsyncd.conf # Open port 873 for rsync New-NetFirewallRule ` -Name \"Rsync Daemon (873)\" ` -DisplayName \"Rsync Daemon (873)\" ` -Protocol TCP ` -LocalPort 873 # Create scheduled task to run rsync daemon $Trigger = New-ScheduledTaskTrigger -AtStartup $Action = New-ScheduledTaskAction ` -Execute \"Powershell.exe\" ` -Argument \"rsync --daemon --config=C:\\rsync\\rsyncd.conf\" Register-ScheduledTask ` -TaskName \"Rsync Daemon\" ` -Trigger $Trigger ` -Action $Action ` -RunLevel Highest ` -User System Parameter Description Path rsync Configuration folder for rsync C:\\rsync\\ rsync_share Shared folder for rsync C:\\rsync_share\\ /cygdrive/c/rsync_share Cygwin path prefix up to the shared folder location C:\\rsync_share\\ auth users = rsync Specifies that only the “rsync” user can connect secrets file = /cygdrive/c/rsync/rsync.passwd Specifies the location of the password file that will be used for authenticating rsync connections. C:\\rsync\\rsync.passwd The format of the rsync password file(C:\\rsync\\rsync.passwd) is as follows:\n1 username:password username: This is the username for the rsync account. password: This is the password for the rsync account. Each line in the file represents a single rsync account. Create multiple accounts by adding additional lines to the file.\nExecute the PowerShell Script run on Windows server to automatically setup rsync daemon, create share folder names “rsync_share” and configure the firewall. moreover, the rsync service startup on reboot.\nRSYNC Client Setup RSYNC Client on Windows Install RSYNC on the client machines. Install Rsync software like a linux through Chocolatey\n1 choco install rsync -y Operating i. Manual On the client PC, create a folder to store rsync data\n1 mkdir -p C:\\rsync_client Directory: C:\\ Mode LastWriteTime Length Name\nd—– 7/11/2023 12:46 PM rsync_client\nFor example:\nTo sync files from client to server (PUSH):\n1 rsync -avz /cygdrive/c/rsync_client rsync://server_ip_address/rsync_share To sync files from server to client (PULL):\n1 rsync -avz rsync://server_ip_address/rsync_share /cygdrive/c/rsync_client To sync files from server to client with --progress flag on Linux\n1 rsync -avz --progress --update --chmod=ugo=rwX --delete rsync://server_ip_address/rsync_share ./rsync_client To sync files from client to server with --password-file flag on Linux\n1 rsync -avz --password-file=\u003c(echo \"your_password\") /cygdrive/c/rsync_client rsync://server_ip_address/rsync_share Option Description -a Enables archive mode -v Enables verbose output -z Enables compression --progress Displays progress during the transfer --update Skips files that are newer on the destination --chmod=ugo=rwX Sets permissions of synced files --delete Removes files on the destination that do not exist on the source rsync://server_ip_address/rsync_share Specifies the remote directory as rsync_share ./ClientFolder Specifies the current directory on the local machine i. Automatic via Script Update Policy to allow execute self PowerShell script.\n1 Set-ExecutionPolicy RemoteSigned Create Windows PowerShell Script Save all below content to a PowerShell script as names “rsync-client.ps1”\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 # Set variables $RsyncPullFolder = \"C:\\rsync_pull\" $RsyncConfigFolder = \"C:\\rsync\" $Source = \"/cygdrive/c/rsync_pull\" $Destination = \"rsync_server_ip::share\" $Username = \"rsync\" $Password = \"P@ssw0rd123!\" $TaskName = \"Rsync Pull\" $TriggerTime = \"08:00\" # Check if rsync_pull and rsync folders exist, and create them if they don't if (!(Test-Path $RsyncPullFolder)) { New-Item -ItemType Directory -Path $RsyncPullFolder } if (!(Test-Path $RsyncConfigFolder)) { New-Item -ItemType Directory -Path $RsyncConfigFolder } New-Item -Path \"$RsyncConfigFolder\" -Name \"rsync.passwd\" -ItemType \"File\" Add-Content -Path \"$RsyncConfigFolder\\rsync.passwd\" -Value \"$Password\" # Build rsync command $RsyncCommand = \"rsync -avz --progress --update --chmod=ugo=rwX --delete --password-file=/cygdrive/c/rsync/rsync.passwd $Username@$Destination $Source\" # Create scheduled task to run rsync command $Trigger = New-ScheduledTaskTrigger -Daily -At $TriggerTime $Action = New-ScheduledTaskAction -Execute \"Powershell.exe\" -Argument \"$RsyncCommand\" Register-ScheduledTask -TaskName $TaskName -Trigger $Trigger -Action $Action -RunLevel Highest -User \"SYSTEM\" Variable Description $RsyncPullFolder Specifies the download directory on the local machine $RsyncConfigFolder Specifies the config file storage directory on the local machine $Source Specifies the source directory on the local machine $Destination Specifies the destination directory on the remote server $Username Specifies the username of the rsync user on the remote server $Password Specifies the password for the rsync user on the remote server $TaskName Specifies the name of the scheduled task $TriggerTime Specifies the time when the scheduled task will run This script runs on a Windows client and automatically sets up an rsync schedule, creates an rsync folder named ‘rsync_pull’, and configures the username and password for authorization.\nConclusion rsync can be a reliable and efficient solution for file synchronization on Windows, with its ability to preserve file attributes, compress data during transfer, and show verbose output.\nTo use rsync on Windows, you can install a version of rsync compatible with Windows, configure your system’s firewall and network settings, and create a configuration file to specify the files and directories to be synced.\nReference How-to Run a PowerShell Script The cygdrive path prefix Related RSYNC USAGE ","wordCount":"1124","inLanguage":"en","image":"https://www.kingtam.tk/img/rsync-windows/rsync-windows.jpg","datePublished":"2023-06-09T09:34:28+08:00","dateModified":"2023-06-09T09:34:28+08:00","author":{"@type":"Person","name":"King Tam"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.kingtam.tk/posts/rsync-windows/"},"publisher":{"@type":"Organization","name":"King's Blog","logo":{"@type":"ImageObject","url":"https://www.kingtam.tk/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.kingtam.tk/ accesskey=h title="King's Blog (Alt + H)">King's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.kingtam.tk/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://www.kingtam.tk/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://www.kingtam.tk/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://www.kingtam.tk/archives/ title=Archives><span>Archives</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://www.kingtam.tk/>Home</a>&nbsp;»&nbsp;<a href=https://www.kingtam.tk/posts/>Posts</a></div><h1 class=post-title>Synchronization Solution on Windows (RSYNC)</h1><div class=post-meta><span title='2023-06-09 09:34:28 +0800 CST'>June 9, 2023</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;1124 words&nbsp;·&nbsp;King Tam</div></header><figure class=entry-cover><img loading=lazy src=https://www.kingtam.tk/img/rsync-windows/rsync-windows.jpg alt></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#setup-rsync-server-on-windows aria-label="Setup RSYNC Server on Windows">Setup RSYNC Server on Windows</a></li><li><a href=#setup-rsync-client-on-windows aria-label="Setup RSYNC Client on Windows">Setup RSYNC Client on Windows</a></li><li><a href=#operating aria-label=Operating>Operating</a></li><li><a href=#conclusion aria-label=Conclusion>Conclusion</a></li><li><a href=#reference aria-label=Reference>Reference</a></li><li><a href=#related aria-label=Related>Related</a></li></ul></div></details></div><div class=post-content><p><a href="https://images.unsplash.com/photo-1551288049-bebda4e38f71?ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&amp;auto=format&amp;fit=crop&amp;w=1470&amp;q=80">img from unsplash</a></p><blockquote><p>These are the basic steps to set up and use an <code>rsync</code> tool for synchronization on Windows.</p></blockquote><hr><table><tr><td bgcolor=#8acc7b style=text-align:center;vertical-align:middle><font size=4 color=white><b>RSYNC Server</b></font></td></tr></table><h3 id=setup-rsync-server-on-windows>Setup RSYNC Server on Windows<a hidden class=anchor aria-hidden=true href=#setup-rsync-server-on-windows>#</a></h3><p><mark><strong>i. Manual Setup</strong></mark></p><ol><li>Install RSYNC on the server machines.
Install <code>Rsync</code> software like a linux through <a href=https://chocolatey.org/install>Chocolatey</a></li></ol><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>choco install rsync -y
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>On the server, create a folder to share</li></ol><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>mkdir -p C:\rsync_share
</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/img/rsync-windows/2023-06-08_164244.png alt=2023-06-08_164244></p><p>e.g. <code>C:\rsync_share</code>. as rsync share folder.</p><ol start=3><li>On the server,Create the <code>C:\rsync\rsyncd.conf</code> file with the following contents:</li></ol><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>[rsync_share]
</span></span><span style=display:flex><span>path = /cygdrive/c/rsync_share
</span></span><span style=display:flex><span>use chroot = no
</span></span><span style=display:flex><span>ignore errors
</span></span><span style=display:flex><span>read only = no
</span></span><span style=display:flex><span>list = yes
</span></span></code></pre></td></tr></table></div></div><p>This configures the share name as &ldquo;<strong>rsync_share</strong>&rdquo; pointing to the <code>C:\rsync_share</code> folder.</p><p>Use <code>cygdrive path prefix</code> as <code>/cygdrive/c/rsync_share</code></p><ol start=4><li>On the server, open PowerShell and run the rsync daemon:</li></ol><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>rsync --daemon --config=C:\rsync\rsyncd.conf
</span></span></code></pre></td></tr></table></div></div><p>This will run the rsync daemon using the config file <code>C:\rsync\rsyncd.conf</code>.</p><ol start=5><li><p>You may need to configure <strong>firewall</strong> rules on the server to allow incoming <code>TCP</code> connections to port <code>873</code></p><p><img loading=lazy src=/img/rsync-windows/2023-06-08_151454.png alt=2023-06-08_151454></p><p>(The rsync daemon default port).</p></li><li><p>Rsync service is set to run automatically on startup on the server via &ldquo;<strong>Task Scheduler</strong>&rdquo;.</p></li></ol><p><img loading=lazy src=/img/rsync-windows/2023-06-08_151641.png alt=2023-06-08_151641></p><p><img loading=lazy src=/img/rsync-windows/2023-06-08_151656.png alt=2023-06-08_151656></p><hr><p><mark><strong>ii. Automatic via Script</strong></mark></p><blockquote><p>Here are Windows scripts to automatically install <code>rsync</code>, configure it, and open the firewall port:</p></blockquote><ol><li>Update Policy to allow execute self PowerShell script.</li></ol><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>Set-ExecutionPolicy RemoteSigned
</span></span></code></pre></td></tr></table></div></div><blockquote><p>Execution Policy Change
The execution policy helps protect you from scripts that you do not trust. Changing the execution policy might expose
you to the security risks described in the about_Execution_Policies help topic at
https:/go.microsoft.com/fwlink/?LinkID=135170. Do you want to change the execution policy?
[Y] Yes [A] Yes to All [N] No [L] No to All [S] Suspend [?] Help (default is &ldquo;N&rdquo;): <mark><strong>y</strong></mark></p></blockquote><ol start=2><li>Create Windows PowerShell Script</li></ol><blockquote><p>Save all below content to a PowerShell script as names &ldquo;rsync-config.ps1&rdquo;</p></blockquote><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#75715e># Create rsync config and share folders</span>
</span></span><span style=display:flex><span>New-Item -Path C:\rsync -ItemType Directory
</span></span><span style=display:flex><span>New-Item -Path C:\rsync_share -ItemType Directory
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Create rsync.conf file</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>@&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>[rsync_share]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>path = /cygdrive/c/rsync_share
</span></span></span><span style=display:flex><span><span style=color:#e6db74>ignore errors
</span></span></span><span style=display:flex><span><span style=color:#e6db74>read only = no
</span></span></span><span style=display:flex><span><span style=color:#e6db74>list = yes
</span></span></span><span style=display:flex><span><span style=color:#e6db74>auth users = rsync
</span></span></span><span style=display:flex><span><span style=color:#e6db74>secrets file = /cygdrive/c/rsync/rsync.passwd
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#34;@</span> | Add-Content -Path C:\rsync\rsyncd.conf
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Open port 873 for rsync</span>
</span></span><span style=display:flex><span>New-NetFirewallRule `
</span></span><span style=display:flex><span>    -Name <span style=color:#e6db74>&#34;Rsync Daemon (873)&#34;</span> `
</span></span><span style=display:flex><span>    -DisplayName <span style=color:#e6db74>&#34;Rsync Daemon (873)&#34;</span> `
</span></span><span style=display:flex><span>    -Protocol TCP `
</span></span><span style=display:flex><span>    -LocalPort <span style=color:#ae81ff>873</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Create scheduled task to run rsync daemon</span>
</span></span><span style=display:flex><span>$Trigger = New-ScheduledTaskTrigger -AtStartup
</span></span><span style=display:flex><span>$Action = New-ScheduledTaskAction `
</span></span><span style=display:flex><span>    -Execute <span style=color:#e6db74>&#34;Powershell.exe&#34;</span> `
</span></span><span style=display:flex><span>    -Argument <span style=color:#e6db74>&#34;rsync --daemon --config=C:\rsync\rsyncd.conf&#34;</span>
</span></span><span style=display:flex><span>Register-ScheduledTask `
</span></span><span style=display:flex><span>    -TaskName <span style=color:#e6db74>&#34;Rsync Daemon&#34;</span> `
</span></span><span style=display:flex><span>    -Trigger $Trigger `
</span></span><span style=display:flex><span>    -Action $Action `
</span></span><span style=display:flex><span>    -RunLevel Highest `
</span></span><span style=display:flex><span>    -User System
</span></span></code></pre></td></tr></table></div></div><table><thead><tr><th>Parameter</th><th>Description</th><th>Path</th></tr></thead><tbody><tr><td>rsync</td><td>Configuration folder for rsync</td><td>C:\rsync\</td></tr><tr><td>rsync_share</td><td>Shared folder for rsync</td><td>C:\rsync_share\</td></tr><tr><td>/cygdrive/c/rsync_share</td><td>Cygwin path prefix up to the shared folder location</td><td>C:\rsync_share\</td></tr><tr><td>auth users = rsync</td><td>Specifies that only the &ldquo;<code>rsync</code>&rdquo; user can connect</td><td></td></tr><tr><td>secrets file = /cygdrive/c/rsync/rsync.passwd</td><td>Specifies the location of the password file that will be used for authenticating rsync connections.</td><td>C:\rsync\rsync.passwd</td></tr></tbody></table><p>The format of the <code>rsync password file</code>(C:\rsync\rsync.passwd) is as follows:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>username:password
</span></span></code></pre></td></tr></table></div></div><ul><li><code>username</code>: This is the username for the rsync account.</li><li><code>password</code>: This is the password for the rsync account.</li></ul><p>Each line in the file represents a single <code>rsync</code> account. Create multiple accounts by adding additional lines to the file.</p><ol start=3><li>Execute the PowerShell Script</li></ol><p><img loading=lazy src=/img/rsync-windows/2023-06-08_151758.png alt=2023-06-08_151758></p><blockquote><p>run on Windows server to automatically setup rsync daemon, create share folder names &ldquo;rsync_share&rdquo; and configure the firewall. moreover, the rsync service startup on reboot.</p></blockquote><hr><table><tr><td bgcolor=#d0402f style=text-align:center;vertical-align:middle><font size=4 color=white><b>RSYNC Client</b></font></td></tr></table><h3 id=setup-rsync-client-on-windows>Setup RSYNC Client on Windows<a hidden class=anchor aria-hidden=true href=#setup-rsync-client-on-windows>#</a></h3><p>Install RSYNC on the client machines.
Install <code>Rsync</code> software like a linux through <a href=https://chocolatey.org/install>Chocolatey</a></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>choco install rsync -y
</span></span></code></pre></td></tr></table></div></div><h3 id=operating>Operating<a hidden class=anchor aria-hidden=true href=#operating>#</a></h3><p><mark><strong>i. Manual</strong></mark></p><p>On the client PC, create a folder to store <code>rsync</code> data</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>mkdir -p C:\rsync_client
</span></span></code></pre></td></tr></table></div></div><blockquote><pre><code>Directory: C:\
</code></pre><p>Mode LastWriteTime Length Name</p><hr><p>d&mdash;&ndash; 7/11/2023 12:46 PM rsync_client</p></blockquote><p>For example:</p><p>To sync files from client to server (<strong>PUSH</strong>):</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>rsync -avz /cygdrive/c/rsync_client  rsync<span style=color:#960050;background-color:#1e0010>:</span>//server_ip_address/rsync_share
</span></span></code></pre></td></tr></table></div></div><p>To sync files from server to client (<strong>PULL</strong>):</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>rsync -avz rsync<span style=color:#960050;background-color:#1e0010>:</span>//server_ip_address/rsync_share /cygdrive/c/rsync_client
</span></span></code></pre></td></tr></table></div></div><p>To sync files from server to client with <code>--progress</code> flag on Linux</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>rsync -avz --progress --update --chmod<span style=color:#f92672>=</span>ugo<span style=color:#f92672>=</span>rwX --delete rsync://server_ip_address/rsync_share ./rsync_client
</span></span></code></pre></td></tr></table></div></div><p>To sync files from client to server with <code>--password-file</code> flag on Linux</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>rsync -avz --password-file<span style=color:#f92672>=</span>&lt;<span style=color:#f92672>(</span>echo <span style=color:#e6db74>&#34;your_password&#34;</span><span style=color:#f92672>)</span> /cygdrive/c/rsync_client rsync://server_ip_address/rsync_share
</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=/img/rsync-windows/2023-06-08_163246.png alt=2023-06-08_163246></p><table><thead><tr><th>Option</th><th>Description</th></tr></thead><tbody><tr><td><code>-a</code></td><td>Enables archive mode</td></tr><tr><td><code>-v</code></td><td>Enables verbose output</td></tr><tr><td><code>-z</code></td><td>Enables compression</td></tr><tr><td><code>--progress</code></td><td>Displays progress during the transfer</td></tr><tr><td><code>--update</code></td><td>Skips files that are newer on the destination</td></tr><tr><td><code>--chmod=ugo=rwX</code></td><td>Sets permissions of synced files</td></tr><tr><td><code>--delete</code></td><td>Removes files on the destination that do not exist on the source</td></tr><tr><td><code>rsync://server_ip_address/rsync_share</code></td><td>Specifies the remote directory as r<code>sync_share</code></td></tr><tr><td><code>./ClientFolder</code></td><td>Specifies the current directory on the local machine</td></tr></tbody></table><p><mark><strong>i. Automatic via Script</strong></mark></p><p>Update Policy to allow execute self PowerShell script.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>Set-ExecutionPolicy RemoteSigned
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>Create Windows PowerShell Script</li></ol><blockquote><p>Save all below content to a PowerShell script as names &ldquo;rsync-client.ps1&rdquo;</p></blockquote><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#75715e># Set variables</span>
</span></span><span style=display:flex><span>$RsyncPullFolder = <span style=color:#e6db74>&#34;C:\rsync_pull&#34;</span>
</span></span><span style=display:flex><span>$RsyncConfigFolder = <span style=color:#e6db74>&#34;C:\rsync&#34;</span>
</span></span><span style=display:flex><span>$Source = <span style=color:#e6db74>&#34;/cygdrive/c/rsync_pull&#34;</span>
</span></span><span style=display:flex><span>$Destination = <span style=color:#e6db74>&#34;rsync_server_ip::share&#34;</span>
</span></span><span style=display:flex><span>$Username = <span style=color:#e6db74>&#34;rsync&#34;</span>
</span></span><span style=display:flex><span>$Password = <span style=color:#e6db74>&#34;P@ssw0rd123!&#34;</span>
</span></span><span style=display:flex><span>$TaskName = <span style=color:#e6db74>&#34;Rsync Pull&#34;</span>
</span></span><span style=display:flex><span>$TriggerTime = <span style=color:#e6db74>&#34;08:00&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Check if rsync_pull and rsync folders exist, and create them if they don&#39;t</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (!(Test-Path $RsyncPullFolder)) {
</span></span><span style=display:flex><span>    New-Item -ItemType Directory -Path $RsyncPullFolder
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (!(Test-Path $RsyncConfigFolder)) {
</span></span><span style=display:flex><span>    New-Item -ItemType Directory -Path $RsyncConfigFolder
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>New-Item -Path <span style=color:#e6db74>&#34;</span>$RsyncConfigFolder<span style=color:#e6db74>&#34;</span> -Name <span style=color:#e6db74>&#34;rsync.passwd&#34;</span> -ItemType <span style=color:#e6db74>&#34;File&#34;</span>
</span></span><span style=display:flex><span>Add-Content -Path <span style=color:#e6db74>&#34;</span>$RsyncConfigFolder<span style=color:#e6db74>\rsync.passwd&#34;</span> -Value <span style=color:#e6db74>&#34;</span>$Password<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Build rsync command</span>
</span></span><span style=display:flex><span>$RsyncCommand = <span style=color:#e6db74>&#34;rsync -avz --progress --update --chmod=ugo=rwX --delete --password-file=/cygdrive/c/rsync/rsync.passwd </span>$Username<span style=color:#e6db74>@</span>$Destination<span style=color:#e6db74> </span>$Source<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Create scheduled task to run rsync command</span>
</span></span><span style=display:flex><span>$Trigger = New-ScheduledTaskTrigger -Daily -At $TriggerTime
</span></span><span style=display:flex><span>$Action = New-ScheduledTaskAction -Execute <span style=color:#e6db74>&#34;Powershell.exe&#34;</span> -Argument <span style=color:#e6db74>&#34;</span>$RsyncCommand<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>Register-ScheduledTask -TaskName $TaskName -Trigger $Trigger -Action $Action -RunLevel Highest -User <span style=color:#e6db74>&#34;SYSTEM&#34;</span>
</span></span></code></pre></td></tr></table></div></div><table><thead><tr><th>Variable</th><th>Description</th></tr></thead><tbody><tr><td><code>$RsyncPullFolder</code></td><td>Specifies the download directory on the local machine</td></tr><tr><td><code>$RsyncConfigFolder</code></td><td>Specifies the config file storage directory on the local machine</td></tr><tr><td><code>$Source</code></td><td>Specifies the source directory on the local machine</td></tr><tr><td><code>$Destination</code></td><td>Specifies the destination directory on the remote server</td></tr><tr><td><code>$Username</code></td><td>Specifies the username of the <code>rsync</code> user on the remote server</td></tr><tr><td><code>$Password</code></td><td>Specifies the password for the <code>rsync</code> user on the remote server</td></tr><tr><td><code>$TaskName</code></td><td>Specifies the name of the scheduled task</td></tr><tr><td><code>$TriggerTime</code></td><td>Specifies the time when the scheduled task will run</td></tr></tbody></table><p>This script runs on a Windows client and automatically sets up an rsync schedule, creates an rsync folder named &lsquo;rsync_pull&rsquo;, and configures the username and password for authorization.</p><hr><h3 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h3><blockquote><p><code>rsync</code> can be a reliable and efficient solution for file synchronization on Windows, with its ability to preserve file attributes, compress data during transfer, and show verbose output.</p><p>To use <code>rsync</code> on Windows, you can install a version of rsync compatible with Windows, configure your system&rsquo;s firewall and network settings, and create a configuration file to specify the files and directories to be synced.</p></blockquote><hr><h3 id=reference>Reference<a hidden class=anchor aria-hidden=true href=#reference>#</a></h3><ul><li><a href=https://lazyadmin.nl/powershell/run-a-powershell-script/>How-to Run a PowerShell Script</a></li><li><a href=https://cygwin.com/cygwin-ug-net/using.html>The cygdrive path prefix</a></li></ul><hr><h3 id=related>Related<a hidden class=anchor aria-hidden=true href=#related>#</a></h3><ul><li><a href=https://kingtam.eu.org/posts/rsync-usage/>RSYNC USAGE</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.kingtam.tk/tags/rsync/>rsync</a></li></ul><nav class=paginav><a class=prev href=https://www.kingtam.tk/posts/linux-inputrc/><span class=title>« Prev</span><br><span>Linux Terminal Tab Completion</span></a>
<a class=next href=https://www.kingtam.tk/posts/rsync-usage/><span class=title>Next »</span><br><span>RSYNC USAGE</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Synchronization Solution on Windows (RSYNC) on twitter" href="https://twitter.com/intent/tweet/?text=Synchronization%20Solution%20on%20Windows%20%28RSYNC%29&amp;url=https%3a%2f%2fwww.kingtam.tk%2fposts%2frsync-windows%2f&amp;hashtags=rsync"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Synchronization Solution on Windows (RSYNC) on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.kingtam.tk%2fposts%2frsync-windows%2f&amp;title=Synchronization%20Solution%20on%20Windows%20%28RSYNC%29&amp;summary=Synchronization%20Solution%20on%20Windows%20%28RSYNC%29&amp;source=https%3a%2f%2fwww.kingtam.tk%2fposts%2frsync-windows%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Synchronization Solution on Windows (RSYNC) on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fwww.kingtam.tk%2fposts%2frsync-windows%2f&title=Synchronization%20Solution%20on%20Windows%20%28RSYNC%29"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Synchronization Solution on Windows (RSYNC) on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.kingtam.tk%2fposts%2frsync-windows%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Synchronization Solution on Windows (RSYNC) on whatsapp" href="https://api.whatsapp.com/send?text=Synchronization%20Solution%20on%20Windows%20%28RSYNC%29%20-%20https%3a%2f%2fwww.kingtam.tk%2fposts%2frsync-windows%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Synchronization Solution on Windows (RSYNC) on telegram" href="https://telegram.me/share/url?text=Synchronization%20Solution%20on%20Windows%20%28RSYNC%29&amp;url=https%3a%2f%2fwww.kingtam.tk%2fposts%2frsync-windows%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://www.kingtam.tk/>King's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>